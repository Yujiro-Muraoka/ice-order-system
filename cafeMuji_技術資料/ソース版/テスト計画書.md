# cafeMuji æ³¨æ–‡ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ  ãƒ†ã‚¹ãƒˆè¨ˆç”»æ›¸

## ğŸš€ æ¦‚è¦
cafeMujiæ³¨æ–‡ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ ã®å“è³ªä¿è¨¼ã®ãŸã‚ã®åŒ…æ‹¬çš„ãªãƒ†ã‚¹ãƒˆè¨ˆç”»æ›¸ã§ã™ã€‚
å˜ä½“ãƒ†ã‚¹ãƒˆã‹ã‚‰çµ±åˆãƒ†ã‚¹ãƒˆã€ãƒ¦ãƒ¼ã‚¶ãƒ“ãƒªãƒ†ã‚£ãƒ†ã‚¹ãƒˆã¾ã§ã€å…¨å·¥ç¨‹ã§ã®ãƒ†ã‚¹ãƒˆæˆ¦ç•¥ã‚’å®šç¾©ã—ã¾ã™ã€‚

## ğŸ“‹ ãƒ†ã‚¹ãƒˆæˆ¦ç•¥

### ãƒ†ã‚¹ãƒˆã®ç›®çš„
- **å“è³ªä¿è¨¼**: ã‚·ã‚¹ãƒ†ãƒ ã®å‹•ä½œä¿è¨¼
- **ãƒã‚°ç™ºè¦‹**: é–‹ç™ºæ®µéšã§ã®å•é¡Œæ—©æœŸç™ºè¦‹
- **ãƒªã‚°ãƒ¬ãƒƒã‚·ãƒ§ãƒ³é˜²æ­¢**: æ—¢å­˜æ©Ÿèƒ½ã®ç ´ç¶»é˜²æ­¢
- **ãƒ¦ãƒ¼ã‚¶ãƒ“ãƒªãƒ†ã‚£å‘ä¸Š**: ãƒ¦ãƒ¼ã‚¶ãƒ¼ä½“é¨“ã®æ”¹å–„

### ãƒ†ã‚¹ãƒˆãƒ¬ãƒ™ãƒ«
1. **å˜ä½“ãƒ†ã‚¹ãƒˆ**: å€‹åˆ¥ã®é–¢æ•°ãƒ»ã‚¯ãƒ©ã‚¹ã®ãƒ†ã‚¹ãƒˆ
2. **çµ±åˆãƒ†ã‚¹ãƒˆ**: ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆé–“ã®é€£æºãƒ†ã‚¹ãƒˆ
3. **ã‚·ã‚¹ãƒ†ãƒ ãƒ†ã‚¹ãƒˆ**: ã‚·ã‚¹ãƒ†ãƒ å…¨ä½“ã®å‹•ä½œãƒ†ã‚¹ãƒˆ
4. **ãƒ¦ãƒ¼ã‚¶ãƒ“ãƒªãƒ†ã‚£ãƒ†ã‚¹ãƒˆ**: ãƒ¦ãƒ¼ã‚¶ãƒ¼ä½“é¨“ã®ãƒ†ã‚¹ãƒˆ

## ğŸ§ª å˜ä½“ãƒ†ã‚¹ãƒˆ

### 1. ãƒ¢ãƒ‡ãƒ«ãƒ†ã‚¹ãƒˆ

#### 1.1 FoodOrderãƒ¢ãƒ‡ãƒ«ãƒ†ã‚¹ãƒˆ
```python
# tests/test_models.py
from django.test import TestCase
from django.utils import timezone
from food.models import FoodOrder

class FoodOrderModelTest(TestCase):
    def setUp(self):
        """ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã®æº–å‚™"""
        self.food_order = FoodOrder.objects.create(
            menu='ã‹ã‚‰ã‚ã’ä¸¼',
            quantity=2,
            eat_in=True,
            clip_color='yellow',
            clip_number=1,
            group_id='test_group_001'
        )
    
    def test_food_order_creation(self):
        """æ³¨æ–‡ä½œæˆã®ãƒ†ã‚¹ãƒˆ"""
        self.assertEqual(self.food_order.menu, 'ã‹ã‚‰ã‚ã’ä¸¼')
        self.assertEqual(self.food_order.quantity, 2)
        self.assertTrue(self.food_order.eat_in)
        self.assertEqual(self.food_order.status, 'ok')
        self.assertFalse(self.food_order.is_completed)
    
    def test_food_order_string_representation(self):
        """æ–‡å­—åˆ—è¡¨ç¾ã®ãƒ†ã‚¹ãƒˆ"""
        expected = f"{self.food_order.menu} Ã—{self.food_order.quantity}"
        self.assertEqual(str(self.food_order), expected)
    
    def test_food_order_validation(self):
        """ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã®ãƒ†ã‚¹ãƒˆ"""
        # æ•°é‡ãŒ0ä»¥ä¸‹ã®å ´åˆ
        with self.assertRaises(ValueError):
            FoodOrder.objects.create(
                menu='ã‹ã‚‰ã‚ã’ä¸¼',
                quantity=0,
                eat_in=True,
                clip_color='yellow',
                clip_number=1,
                group_id='test_group_001'
            )
    
    def test_food_order_completion(self):
        """æ³¨æ–‡å®Œäº†ã®ãƒ†ã‚¹ãƒˆ"""
        self.food_order.is_completed = True
        self.food_order.completed_at = timezone.now()
        self.food_order.save()
        
        self.assertTrue(self.food_order.is_completed)
        self.assertIsNotNone(self.food_order.completed_at)
```

#### 1.2 Orderãƒ¢ãƒ‡ãƒ«ãƒ†ã‚¹ãƒˆï¼ˆã‚¢ã‚¤ã‚¹ã‚¯ãƒªãƒ¼ãƒ ï¼‰
```python
# tests/test_ice_models.py
from django.test import TestCase
from ice.models import Order

class OrderModelTest(TestCase):
    def setUp(self):
        """ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã®æº–å‚™"""
        self.order = Order.objects.create(
            group_id='test_group_001',
            size='S',
            container='cup',
            flavor1='jersey',
            clip_color='white',
            clip_number=2
        )
    
    def test_order_creation(self):
        """æ³¨æ–‡ä½œæˆã®ãƒ†ã‚¹ãƒˆ"""
        self.assertEqual(self.order.size, 'S')
        self.assertEqual(self.order.container, 'cup')
        self.assertEqual(self.order.flavor1, 'jersey')
        self.assertIsNone(self.order.flavor2)
    
    def test_double_flavor_order(self):
        """ãƒ€ãƒ–ãƒ«ãƒ•ãƒ¬ãƒ¼ãƒãƒ¼æ³¨æ–‡ã®ãƒ†ã‚¹ãƒˆ"""
        double_order = Order.objects.create(
            group_id='test_group_002',
            size='W',
            container='cone',
            flavor1='jersey',
            flavor2='mango',
            clip_color='yellow',
            clip_number=3
        )
        
        self.assertEqual(double_order.size, 'W')
        self.assertEqual(double_order.flavor2, 'mango')
```

### 2. ãƒ“ãƒ¥ãƒ¼ãƒ†ã‚¹ãƒˆ

#### 2.1 ãƒ•ãƒ¼ãƒ‰æ³¨æ–‡ãƒ“ãƒ¥ãƒ¼ãƒ†ã‚¹ãƒˆ
```python
# tests/test_food_views.py
from django.test import TestCase, Client
from django.urls import reverse
from food.models import FoodOrder

class FoodViewsTest(TestCase):
    def setUp(self):
        """ãƒ†ã‚¹ãƒˆã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã¨ãƒ‡ãƒ¼ã‚¿ã®æº–å‚™"""
        self.client = Client()
        self.food_order = FoodOrder.objects.create(
            menu='ã‹ã‚‰ã‚ã’ä¸¼',
            quantity=1,
            eat_in=True,
            clip_color='yellow',
            clip_number=1,
            group_id='test_group_001'
        )
    
    def test_food_register_view(self):
        """æ³¨æ–‡ç™»éŒ²ç”»é¢ã®è¡¨ç¤ºãƒ†ã‚¹ãƒˆ"""
        response = self.client.get(reverse('food_register'))
        self.assertEqual(response.status_code, 200)
        self.assertTemplateUsed(response, 'food/food_register.html')
    
    def test_add_temp_food_view(self):
        """ä»®æ³¨æ–‡è¿½åŠ ã®ãƒ†ã‚¹ãƒˆ"""
        response = self.client.post(reverse('add_temp_food'), {
            'menu': 'ãƒ«ãƒ¼ãƒ­ãƒ¼é£¯',
            'quantity': '2',
            'eat_in': '1'
        })
        
        self.assertEqual(response.status_code, 302)  # ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆ
        # ã‚»ãƒƒã‚·ãƒ§ãƒ³ã«ä»®æ³¨æ–‡ãŒè¿½åŠ ã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèª
        session = self.client.session
        self.assertIn('temp_food', session)
        temp_food = session['temp_food']
        self.assertEqual(len(temp_food), 1)
        self.assertEqual(temp_food[0]['menu'], 'ãƒ«ãƒ¼ãƒ­ãƒ¼é£¯')
    
    def test_food_kitchen_view(self):
        """ã‚­ãƒƒãƒãƒ³ç”»é¢ã®è¡¨ç¤ºãƒ†ã‚¹ãƒˆ"""
        response = self.client.get(reverse('food_kitchen'))
        self.assertEqual(response.status_code, 200)
        self.assertTemplateUsed(response, 'food/food_kitchen.html')
        self.assertContains(response, 'ã‹ã‚‰ã‚ã’ä¸¼')
```

#### 2.2 ã‚¢ã‚¤ã‚¹ã‚¯ãƒªãƒ¼ãƒ æ³¨æ–‡ãƒ“ãƒ¥ãƒ¼ãƒ†ã‚¹ãƒˆ
```python
# tests/test_ice_views.py
from django.test import TestCase, Client
from django.urls import reverse
from ice.models import Order

class IceViewsTest(TestCase):
    def setUp(self):
        """ãƒ†ã‚¹ãƒˆã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã¨ãƒ‡ãƒ¼ã‚¿ã®æº–å‚™"""
        self.client = Client()
        self.order = Order.objects.create(
            group_id='test_group_001',
            size='S',
            container='cup',
            flavor1='jersey',
            clip_color='white',
            clip_number=1
        )
    
    def test_ice_view(self):
        """ã‚¢ã‚¤ã‚¹ã‚¯ãƒªãƒ¼ãƒ æ³¨æ–‡ç”»é¢ã®è¡¨ç¤ºãƒ†ã‚¹ãƒˆ"""
        response = self.client.get(reverse('ice'))
        self.assertEqual(response.status_code, 200)
        self.assertTemplateUsed(response, 'ice/ice.html')
    
    def test_ice_register_view(self):
        """ã‚¢ã‚¤ã‚¹ã‚¯ãƒªãƒ¼ãƒ æ³¨æ–‡ç™»éŒ²ã®ãƒ†ã‚¹ãƒˆ"""
        response = self.client.post(reverse('ice_register'), {
            'size': 'W',
            'container': 'cone',
            'flavor1': 'jersey',
            'flavor2': 'mango',
            'clip_color': 'yellow',
            'clip_number': '2'
        })
        
        self.assertEqual(response.status_code, 200)
        # æ³¨æ–‡ãŒä½œæˆã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèª
        orders = Order.objects.filter(group_id='test_group_001')
        self.assertEqual(orders.count(), 2)
```

### 3. ãƒ•ã‚©ãƒ¼ãƒ ãƒ†ã‚¹ãƒˆ

#### 3.1 æ³¨æ–‡ãƒ•ã‚©ãƒ¼ãƒ ãƒ†ã‚¹ãƒˆ
```python
# tests/test_forms.py
from django.test import TestCase
from food.forms import FoodOrderForm

class FoodOrderFormTest(TestCase):
    def test_valid_food_order_form(self):
        """æœ‰åŠ¹ãªæ³¨æ–‡ãƒ•ã‚©ãƒ¼ãƒ ã®ãƒ†ã‚¹ãƒˆ"""
        form_data = {
            'menu': 'ã‹ã‚‰ã‚ã’ä¸¼',
            'quantity': 2,
            'eat_in': True,
            'clip_color': 'yellow',
            'clip_number': 1,
            'group_id': 'test_group_001'
        }
        form = FoodOrderForm(data=form_data)
        self.assertTrue(form.is_valid())
    
    def test_invalid_food_order_form(self):
        """ç„¡åŠ¹ãªæ³¨æ–‡ãƒ•ã‚©ãƒ¼ãƒ ã®ãƒ†ã‚¹ãƒˆ"""
        # æ•°é‡ãŒ0ã®å ´åˆ
        form_data = {
            'menu': 'ã‹ã‚‰ã‚ã’ä¸¼',
            'quantity': 0,
            'eat_in': True,
            'clip_color': 'yellow',
            'clip_number': 1,
            'group_id': 'test_group_001'
        }
        form = FoodOrderForm(data=form_data)
        self.assertFalse(form.is_valid())
        self.assertIn('quantity', form.errors)
```

## ğŸ”— çµ±åˆãƒ†ã‚¹ãƒˆ

### 1. æ³¨æ–‡ãƒ•ãƒ­ãƒ¼ãƒ†ã‚¹ãƒˆ

#### 1.1 å®Œå…¨ãªæ³¨æ–‡ãƒ•ãƒ­ãƒ¼
```python
# tests/test_integration.py
from django.test import TestCase, Client
from django.urls import reverse
from food.models import FoodOrder

class OrderFlowIntegrationTest(TestCase):
    def setUp(self):
        """ãƒ†ã‚¹ãƒˆã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã®æº–å‚™"""
        self.client = Client()
    
    def test_complete_order_flow(self):
        """å®Œå…¨ãªæ³¨æ–‡ãƒ•ãƒ­ãƒ¼ã®ãƒ†ã‚¹ãƒˆ"""
        # 1. æ³¨æ–‡ç™»éŒ²ç”»é¢ã«ã‚¢ã‚¯ã‚»ã‚¹
        response = self.client.get(reverse('food_register'))
        self.assertEqual(response.status_code, 200)
        
        # 2. ä»®æ³¨æ–‡ã‚’è¿½åŠ 
        response = self.client.post(reverse('add_temp_food'), {
            'menu': 'ã‹ã‚‰ã‚ã’ä¸¼',
            'quantity': '2',
            'eat_in': '1'
        })
        self.assertEqual(response.status_code, 302)
        
        # 3. ä»®æ³¨æ–‡ãŒã‚»ãƒƒã‚·ãƒ§ãƒ³ã«ä¿å­˜ã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèª
        session = self.client.session
        self.assertIn('temp_food', session)
        temp_food = session['temp_food']
        self.assertEqual(len(temp_food), 1)
        
        # 4. æœ¬æ³¨æ–‡ã‚’ç¢ºå®š
        response = self.client.post(reverse('confirm_food'), {
            'clip_color': 'yellow',
            'clip_number': '1'
        })
        self.assertEqual(response.status_code, 302)
        
        # 5. ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«æ³¨æ–‡ãŒä¿å­˜ã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèª
        orders = FoodOrder.objects.all()
        self.assertEqual(orders.count(), 1)
        order = orders.first()
        self.assertEqual(order.menu, 'ã‹ã‚‰ã‚ã’ä¸¼')
        self.assertEqual(order.quantity, 2)
        self.assertTrue(order.eat_in)
        
        # 6. ã‚­ãƒƒãƒãƒ³ç”»é¢ã§æ³¨æ–‡ãŒè¡¨ç¤ºã•ã‚Œã‚‹ã‹ç¢ºèª
        response = self.client.get(reverse('food_kitchen'))
        self.assertEqual(response.status_code, 200)
        self.assertContains(response, 'ã‹ã‚‰ã‚ã’ä¸¼')
        
        # 7. æ³¨æ–‡ã‚’å®Œäº†
        response = self.client.post(reverse('complete_food'), {
            'order_id': order.id
        })
        self.assertEqual(response.status_code, 302)
        
        # 8. å®Œäº†çŠ¶æ…‹ãŒæ›´æ–°ã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèª
        order.refresh_from_db()
        self.assertTrue(order.is_completed)
        self.assertIsNotNone(order.completed_at)
```

### 2. ã‚»ãƒƒã‚·ãƒ§ãƒ³ç®¡ç†ãƒ†ã‚¹ãƒˆ

#### 2.1 ã‚»ãƒƒã‚·ãƒ§ãƒ³ã®æ°¸ç¶šæ€§
```python
# tests/test_session.py
from django.test import TestCase, Client
from django.urls import reverse

class SessionManagementTest(TestCase):
    def setUp(self):
        """ãƒ†ã‚¹ãƒˆã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã®æº–å‚™"""
        self.client = Client()
    
    def test_session_persistence(self):
        """ã‚»ãƒƒã‚·ãƒ§ãƒ³ã®æ°¸ç¶šæ€§ãƒ†ã‚¹ãƒˆ"""
        # 1. ä»®æ³¨æ–‡ã‚’è¿½åŠ 
        response = self.client.post(reverse('add_temp_food'), {
            'menu': 'ã‹ã‚‰ã‚ã’ä¸¼',
            'quantity': '1',
            'eat_in': '1'
        })
        
        # 2. åˆ¥ã®ç”»é¢ã«ç§»å‹•
        response = self.client.get(reverse('food_kitchen'))
        
        # 3. æ³¨æ–‡ç™»éŒ²ç”»é¢ã«æˆ»ã‚‹
        response = self.client.get(reverse('food_register'))
        
        # 4. ã‚»ãƒƒã‚·ãƒ§ãƒ³ã«ä»®æ³¨æ–‡ãŒä¿æŒã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèª
        session = self.client.session
        self.assertIn('temp_food', session)
        temp_food = session['temp_food']
        self.assertEqual(len(temp_food), 1)
        self.assertEqual(temp_food[0]['menu'], 'ã‹ã‚‰ã‚ã’ä¸¼')
```

## ğŸ–¥ï¸ ã‚·ã‚¹ãƒ†ãƒ ãƒ†ã‚¹ãƒˆ

### 1. ã‚¨ãƒ³ãƒ‰ãƒ„ãƒ¼ã‚¨ãƒ³ãƒ‰ãƒ†ã‚¹ãƒˆ

#### 1.1 å…¨æ©Ÿèƒ½ã®å‹•ä½œç¢ºèª
```python
# tests/test_system.py
from django.test import TestCase, Client
from django.urls import reverse
from food.models import FoodOrder
from ice.models import Order
from shavedice.models import ShavedIceOrder

class SystemIntegrationTest(TestCase):
    def setUp(self):
        """ãƒ†ã‚¹ãƒˆã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã®æº–å‚™"""
        self.client = Client()
    
    def test_full_system_workflow(self):
        """å…¨ã‚·ã‚¹ãƒ†ãƒ ã®ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ãƒ†ã‚¹ãƒˆ"""
        # 1. ãƒ•ãƒ¼ãƒ‰æ³¨æ–‡
        self.client.post(reverse('add_temp_food'), {
            'menu': 'ã‹ã‚‰ã‚ã’ä¸¼',
            'quantity': '1',
            'eat_in': '1'
        })
        
        self.client.post(reverse('confirm_food'), {
            'clip_color': 'yellow',
            'clip_number': '1'
        })
        
        # 2. ã‚¢ã‚¤ã‚¹ã‚¯ãƒªãƒ¼ãƒ æ³¨æ–‡
        self.client.post(reverse('ice_register'), {
            'size': 'S',
            'container': 'cup',
            'flavor1': 'jersey',
            'clip_color': 'white',
            'clip_number': '2'
        })
        
        # 3. ã‹ãæ°·æ³¨æ–‡
        self.client.post(reverse('shavedice_register'), {
            'flavor': 'æŠ¹èŒ¶',
            'clip_color': 'yellow',
            'clip_number': '3'
        })
        
        # 4. å„æ³¨æ–‡ãŒãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«ä¿å­˜ã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèª
        food_orders = FoodOrder.objects.all()
        ice_orders = Order.objects.all()
        shavedice_orders = ShavedIceOrder.objects.all()
        
        self.assertEqual(food_orders.count(), 1)
        self.assertEqual(ice_orders.count(), 1)
        self.assertEqual(shavedice_orders.count(), 1)
        
        # 5. ã‚­ãƒƒãƒãƒ³ç”»é¢ã§å…¨æ³¨æ–‡ãŒè¡¨ç¤ºã•ã‚Œã‚‹ã‹ç¢ºèª
        response = self.client.get(reverse('food_kitchen'))
        self.assertContains(response, 'ã‹ã‚‰ã‚ã’ä¸¼')
        
        response = self.client.get(reverse('ice_kitchen'))
        self.assertContains(response, 'jersey')
        
        response = self.client.get(reverse('shavedice_kitchen'))
        self.assertContains(response, 'æŠ¹èŒ¶')
```

### 2. ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ†ã‚¹ãƒˆ

#### 2.1 å¤§é‡ãƒ‡ãƒ¼ã‚¿å‡¦ç†
```python
# tests/test_performance.py
from django.test import TestCase, Client
from django.urls import reverse
from django.utils import timezone
from food.models import FoodOrder
import time

class PerformanceTest(TestCase):
    def setUp(self):
        """ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã®æº–å‚™"""
        self.client = Client()
        
        # å¤§é‡ã®ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã‚’ä½œæˆ
        for i in range(100):
            FoodOrder.objects.create(
                menu='ã‹ã‚‰ã‚ã’ä¸¼' if i % 2 == 0 else 'ãƒ«ãƒ¼ãƒ­ãƒ¼é£¯',
                quantity=1,
                eat_in=True,
                clip_color='yellow' if i % 2 == 0 else 'white',
                clip_number=i + 1,
                group_id=f'test_group_{i:03d}',
                timestamp=timezone.now()
            )
    
    def test_large_data_loading(self):
        """å¤§é‡ãƒ‡ãƒ¼ã‚¿ã®èª­ã¿è¾¼ã¿ãƒ†ã‚¹ãƒˆ"""
        start_time = time.time()
        
        response = self.client.get(reverse('food_kitchen'))
        
        end_time = time.time()
        load_time = end_time - start_time
        
        self.assertEqual(response.status_code, 200)
        self.assertLess(load_time, 1.0)  # 1ç§’ä»¥å†…ã§èª­ã¿è¾¼ã¿å®Œäº†
        
        # æ³¨æ–‡æ•°ãŒæ­£ã—ãè¡¨ç¤ºã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèª
        self.assertContains(response, '100')
```

## ğŸ‘¥ ãƒ¦ãƒ¼ã‚¶ãƒ“ãƒªãƒ†ã‚£ãƒ†ã‚¹ãƒˆ

### 1. ç”»é¢è¡¨ç¤ºãƒ†ã‚¹ãƒˆ

#### 1.1 ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–ãƒ‡ã‚¶ã‚¤ãƒ³
```python
# tests/test_usability.py
from django.test import TestCase, Client
from django.urls import reverse

class UsabilityTest(TestCase):
    def setUp(self):
        """ãƒ†ã‚¹ãƒˆã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã®æº–å‚™"""
        self.client = Client()
    
    def test_responsive_design(self):
        """ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–ãƒ‡ã‚¶ã‚¤ãƒ³ã®ãƒ†ã‚¹ãƒˆ"""
        # ãƒ‡ã‚¹ã‚¯ãƒˆãƒƒãƒ—ã‚µã‚¤ã‚ºã§ã®è¡¨ç¤º
        response = self.client.get(reverse('food_register'))
        self.assertEqual(response.status_code, 200)
        
        # ãƒ¢ãƒã‚¤ãƒ«ã‚µã‚¤ã‚ºã§ã®è¡¨ç¤º
        response = self.client.get(reverse('mobile_order'))
        self.assertEqual(response.status_code, 200)
    
    def test_accessible_navigation(self):
        """ã‚¢ã‚¯ã‚»ã‚·ãƒ–ãƒ«ãªãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ã®ãƒ†ã‚¹ãƒˆ"""
        # å„ç”»é¢ã¸ã®ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ãŒå¯èƒ½ã‹ç¢ºèª
        urls = [
            'food_register',
            'food_kitchen',
            'ice',
            'shavedice',
            'mobile_order'
        ]
        
        for url_name in urls:
            try:
                response = self.client.get(reverse(url_name))
                self.assertEqual(response.status_code, 200)
            except:
                # ä¸€éƒ¨ã®URLã¯èªè¨¼ãŒå¿…è¦ãªå ´åˆãŒã‚ã‚‹
                pass
```

### 2. ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ãƒ†ã‚¹ãƒˆ

#### 2.1 ä¸æ­£ãªå…¥åŠ›ã®å‡¦ç†
```python
# tests/test_error_handling.py
from django.test import TestCase, Client
from django.urls import reverse

class ErrorHandlingTest(TestCase):
    def setUp(self):
        """ãƒ†ã‚¹ãƒˆã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã®æº–å‚™"""
        self.client = Client()
    
    def test_invalid_input_handling(self):
        """ä¸æ­£ãªå…¥åŠ›ã®å‡¦ç†ãƒ†ã‚¹ãƒˆ"""
        # æ•°é‡ãŒ0ã®å ´åˆ
        response = self.client.post(reverse('add_temp_food'), {
            'menu': 'ã‹ã‚‰ã‚ã’ä¸¼',
            'quantity': '0',
            'eat_in': '1'
        })
        
        # ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ãŒé©åˆ‡ã«è¡Œã‚ã‚Œã¦ã„ã‚‹ã‹ç¢ºèª
        self.assertEqual(response.status_code, 302)  # ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆ
        
        # ã‚»ãƒƒã‚·ãƒ§ãƒ³ã«ä¸æ­£ãªãƒ‡ãƒ¼ã‚¿ãŒä¿å­˜ã•ã‚Œã¦ã„ãªã„ã‹ç¢ºèª
        session = self.client.session
        if 'temp_food' in session:
            temp_food = session['temp_food']
            for item in temp_food:
                self.assertGreater(item['quantity'], 0)
    
    def test_missing_required_fields(self):
        """å¿…é ˆãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã®æ¬ æãƒ†ã‚¹ãƒˆ"""
        # ãƒ¡ãƒ‹ãƒ¥ãƒ¼ãŒæŒ‡å®šã•ã‚Œã¦ã„ãªã„å ´åˆ
        response = self.client.post(reverse('add_temp_food'), {
            'quantity': '1',
            'eat_in': '1'
        })
        
        self.assertEqual(response.status_code, 302)
```

## ğŸ”§ ãƒ†ã‚¹ãƒˆç’°å¢ƒã®è¨­å®š

### 1. ãƒ†ã‚¹ãƒˆè¨­å®š

#### 1.1 Djangoè¨­å®š
```python
# settings_test.py
from .settings import *

# ãƒ†ã‚¹ãƒˆç”¨ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹è¨­å®š
DATABASES = {
    'default': {
        'ENGINE': 'django.db.backends.sqlite3',
        'NAME': ':memory:',
    }
}

# ãƒ†ã‚¹ãƒˆç”¨ã®è¨­å®š
DEBUG = False
TEMPLATES[0]['OPTIONS']['debug'] = False

# ãƒ†ã‚¹ãƒˆç”¨ã®ã‚»ãƒƒã‚·ãƒ§ãƒ³è¨­å®š
SESSION_ENGINE = 'django.contrib.sessions.backends.db'
```

#### 1.2 ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹
```python
# tests/conftest.py
import pytest
from django.conf import settings

@pytest.fixture(scope='session')
def django_db_setup(django_db_setup, django_db_blocker):
    with django_db_blocker.unblock():
        # ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®åˆæœŸåŒ–
        from django.core.management import call_command
        call_command('migrate')
```

### 2. ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ

#### 2.1 åŸºæœ¬çš„ãªãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
```bash
# å…¨ãƒ†ã‚¹ãƒˆã®å®Ÿè¡Œ
python manage.py test

# ç‰¹å®šã‚¢ãƒ—ãƒªã®ãƒ†ã‚¹ãƒˆ
python manage.py test food
python manage.py test ice
python manage.py test shavedice

# ç‰¹å®šã®ãƒ†ã‚¹ãƒˆã‚¯ãƒ©ã‚¹ã®å®Ÿè¡Œ
python manage.py test tests.test_models.FoodOrderModelTest

# ç‰¹å®šã®ãƒ†ã‚¹ãƒˆãƒ¡ã‚½ãƒƒãƒ‰ã®å®Ÿè¡Œ
python manage.py test tests.test_models.FoodOrderModelTest.test_food_order_creation
```

#### 2.2 ã‚«ãƒãƒ¬ãƒƒã‚¸ä»˜ããƒ†ã‚¹ãƒˆ
```bash
# ã‚«ãƒãƒ¬ãƒƒã‚¸ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
pip install coverage

# ã‚«ãƒãƒ¬ãƒƒã‚¸ä»˜ããƒ†ã‚¹ãƒˆå®Ÿè¡Œ
coverage run --source='.' manage.py test

# ã‚«ãƒãƒ¬ãƒƒã‚¸ãƒ¬ãƒãƒ¼ãƒˆã®è¡¨ç¤º
coverage report

# HTMLãƒ¬ãƒãƒ¼ãƒˆã®ç”Ÿæˆ
coverage html
```

## ğŸ“Š ãƒ†ã‚¹ãƒˆãƒ¡ãƒˆãƒªã‚¯ã‚¹

### 1. ã‚«ãƒãƒ¬ãƒƒã‚¸ç›®æ¨™
- **ã‚³ãƒ¼ãƒ‰ã‚«ãƒãƒ¬ãƒƒã‚¸**: 90%ä»¥ä¸Š
- **ãƒ–ãƒ©ãƒ³ãƒã‚«ãƒãƒ¬ãƒƒã‚¸**: 85%ä»¥ä¸Š
- **é–¢æ•°ã‚«ãƒãƒ¬ãƒƒã‚¸**: 95%ä»¥ä¸Š

### 2. å“è³ªãƒ¡ãƒˆãƒªã‚¯ã‚¹
- **ãƒã‚°å¯†åº¦**: 1000è¡Œã‚ãŸã‚Š1ä»¶ä»¥ä¸‹
- **ãƒ†ã‚¹ãƒˆå®Ÿè¡Œæ™‚é–“**: å…¨ãƒ†ã‚¹ãƒˆ5åˆ†ä»¥å†…
- **ãƒ†ã‚¹ãƒˆæˆåŠŸç‡**: 99%ä»¥ä¸Š

## ğŸš€ ç¶™ç¶šçš„ãƒ†ã‚¹ãƒˆ

### 1. CI/CDçµ±åˆ

#### 1.1 GitHub Actionsè¨­å®š
```yaml
# .github/workflows/test.yml
name: Tests

on: [push, pull_request]

jobs:
  test:
    runs-on: ubuntu-latest
    
    steps:
    - uses: actions/checkout@v2
    
    - name: Set up Python
      uses: actions/setup-python@v2
      with:
        python-version: 3.11
    
    - name: Install dependencies
      run: |
        python -m pip install --upgrade pip
        pip install -r requirements.txt
        pip install coverage
    
    - name: Run tests
      run: |
        coverage run --source='.' manage.py test
    
    - name: Generate coverage report
      run: |
        coverage report
        coverage html
    
    - name: Upload coverage to Codecov
      uses: codecov/codecov-action@v1
```

### 2. è‡ªå‹•ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ

#### 2.1 äº‹å‰ã‚³ãƒŸãƒƒãƒˆãƒ•ãƒƒã‚¯
```bash
#!/bin/bash
# .git/hooks/pre-commit

echo "Running tests before commit..."

# ãƒ†ã‚¹ãƒˆã®å®Ÿè¡Œ
python manage.py test --keepdb

if [ $? -ne 0 ]; then
    echo "Tests failed. Commit aborted."
    exit 1
fi

echo "All tests passed. Proceeding with commit."
```

## ğŸ“ ãƒ†ã‚¹ãƒˆãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ

### 1. ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹ç®¡ç†

#### 1.1 ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ
```markdown
## ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹: TC-001

### æ¦‚è¦
ãƒ•ãƒ¼ãƒ‰æ³¨æ–‡ã®ä½œæˆæ©Ÿèƒ½ã®ãƒ†ã‚¹ãƒˆ

### å‰ææ¡ä»¶
- ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒãƒ­ã‚°ã‚¤ãƒ³ã—ã¦ã„ã‚‹
- æ³¨æ–‡ç™»éŒ²ç”»é¢ãŒè¡¨ç¤ºã•ã‚Œã¦ã„ã‚‹

### ãƒ†ã‚¹ãƒˆæ‰‹é †
1. ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‚’é¸æŠã™ã‚‹
2. æ•°é‡ã‚’å…¥åŠ›ã™ã‚‹
3. åº—å†…/ãƒ†ã‚¤ã‚¯ã‚¢ã‚¦ãƒˆã‚’é¸æŠã™ã‚‹
4. è¿½åŠ ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ã™ã‚‹

### æœŸå¾…çµæœ
- ä»®æ³¨æ–‡ãŒã‚»ãƒƒã‚·ãƒ§ãƒ³ã«ä¿å­˜ã•ã‚Œã‚‹
- ä»®æ³¨æ–‡ä¸€è¦§ã«é¸æŠã—ãŸå•†å“ãŒè¡¨ç¤ºã•ã‚Œã‚‹
- ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒè¡¨ç¤ºã•ã‚Œãªã„

### å®Ÿéš›ã®çµæœ
[ãƒ†ã‚¹ãƒˆå®Ÿè¡Œå¾Œã«è¨˜å…¥]

### ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹
- [ ] æˆåŠŸ
- [ ] å¤±æ•—
- [ ] ãƒ–ãƒ­ãƒƒã‚¯

### å‚™è€ƒ
[ç‰¹è¨˜äº‹é …ãŒã‚ã‚Œã°è¨˜å…¥]
```

### 2. ãƒ†ã‚¹ãƒˆçµæœãƒ¬ãƒãƒ¼ãƒˆ

#### 2.1 ãƒ†ã‚¹ãƒˆå®Ÿè¡Œãƒ¬ãƒãƒ¼ãƒˆ
```bash
# ãƒ†ã‚¹ãƒˆçµæœã®è©³ç´°ãƒ¬ãƒãƒ¼ãƒˆ
python manage.py test --verbosity=2

# XMLå½¢å¼ã§ã®ãƒ¬ãƒãƒ¼ãƒˆå‡ºåŠ›
python manage.py test --output=test-results.xml
```

---

**ä½œæˆæ—¥**: 2025å¹´8æœˆ
**ä½œæˆè€…**: æ‘å²¡ å„ªæ¬¡éƒ
**ãƒãƒ¼ã‚¸ãƒ§ãƒ³**: 1.0
