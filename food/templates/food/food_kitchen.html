<h1>ğŸ½ ã‚­ãƒƒãƒãƒ³ç”»é¢</h1>
<p>æœ€çµ‚æ›´æ–°: {{ now|time:"H:i:s" }}</p>

<h2>ğŸ”§ æœªå®Œäº†ã‚ªãƒ¼ãƒ€ãƒ¼</h2>
{% for group_id, orders in active_orders.items %}
  <div style="border: 2px dashed #999; padding: 12px; margin-bottom: 16px;">
    <strong>ğŸ§¾ ã‚ªãƒ¼ãƒ€ãƒ¼ç•ªå·: {{ orders.0.clip_color }} - {{ orders.0.clip_number }}</strong><br>
    <ul>
      {% for order in orders %}
        <li>{{ order.menu }} Ã—{{ order.quantity }}</li>
      {% endfor %}
    </ul>
    <form method="post" action="/food/complete_group/{{ group_id }}/">
      {% csrf_token %}
      <button type="submit">âœ… ä½œæˆå®Œäº†</button>
    </form>
  </div>
{% empty %}
  <p>ç¾åœ¨ã‚ªãƒ¼ãƒ€ãƒ¼ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚</p>
{% endfor %}

<h2>âœ… å®Œäº†æ¸ˆã¿ã‚ªãƒ¼ãƒ€ãƒ¼ï¼ˆ30ç§’é–“è¡¨ç¤ºï¼‰</h2>
{% for group_id, orders in completed_orders.items %}
  <div style="border: 1px solid #ccc; padding: 10px; margin-bottom: 12px;" data-completed="{{ orders.0.completed_at|date:'Y-m-d H:i:s' }}">
    <strong>ğŸ§¾ {{ orders.0.clip_color }} - {{ orders.0.clip_number }}</strong><br>
    <ul>
      {% for order in orders %}
        <li>{{ order.menu }} Ã—{{ order.quantity }}</li>
      {% endfor %}
    </ul>
    <p class="countdown-text">â³ ã“ã®ã‚ªãƒ¼ãƒ€ãƒ¼ã¯ <span class="countdown">30</span> ç§’å¾Œã«æ¶ˆãˆã¾ã™</p>
  </div>
{% endfor %}

<script>
  function updateCountdowns() {
    const now = new Date().getTime();
    document.querySelectorAll('[data-completed]').forEach(el => {
      const completedAt = new Date(el.dataset.completed.replace(' ', 'T')).getTime();
      const elapsed = Math.floor((now - completedAt) / 1000);
      const remaining = 30 - elapsed;
      const countdown = el.querySelector('.countdown');
      if (countdown) countdown.textContent = remaining > 0 ? remaining : 0;
      if (remaining <= 0) el.remove();
    });
  }
  setInterval(updateCountdowns, 1000);
</script>
<form action="/" method="get">
  <button type="submit" class="primary-button" style="background-color: #ccc; color: #000;">â† å½¹å‰²é¸æŠã¸æˆ»ã‚‹</button>
</form>
