# CafeMuji 注文管理システム - アプリケーション概要

本ドキュメントはリポジトリのコードと設定から読み取れるシステム構成を短くまとめたものです。初回キャッチアップやレビュー時の入口として利用してください。

## 目的と範囲
- フード、アイスクリーム、かき氷の3系統の注文を一元管理するDjango 5系アプリケーション。
- REST APIとWeb UIを両立し、Render.comなどのPaaSにデプロイ可能な構成。

## 技術スタック
- **フレームワーク**: Django 5.2 / Django REST Framework 3.14
- **言語**: Python 3.13
- **DB**: SQLite（環境変数 `DATABASE_URL` 指定でPostgreSQLに切替）
- **キャッシュ**: LocMem Cache（開発向け、TTL 300秒、最大1000エントリ）
- **その他**: CORS対応、django-extensions、簡易コンソールロギング

## アプリケーション構成
- `ice` : ルート (`/`) に紐づくアイスクリーム注文管理。クリップ色＋番号やフレーバー選択肢を持つ。
- `food` : `/food/` 配下のフード注文管理。
- `shavedice` : `/shavedice/` 配下のかき氷注文管理。
- `mobile` : `/mobile/` 配下のモバイルオーダー画面用ルーティング。
- `api` : `/api/` 配下のREST API。ヘルスチェックや統計エンドポイントを含む。

URLルーティングは `config/urls.py` でまとめ、管理画面（`/admin/`）も有効化されています。

## データモデルの例（iceアプリ）
- `ice.models.Order` はグループID、サイズ、容器、最大2種類のフレーバー、完了フラグ、ステータス、クリップ色＋番号などを保持。
- タイムスタンプや状態変更時刻を含み、インデックス（ステータス×完了、クリップ色×番号、グループID、タイムスタンプなど）で検索最適化。

## REST API と表示
- DRFのブラウザブルAPIが有効で、`/api/` 以下にAPI root・ヘルスチェック・注文統計などが公開。
- 主要画面URLは README 記載の通り：
  - アイス：`/`
  - フード：`/food/`
  - かき氷：`/shavedice/`

## 設定ハイライト
- デフォルトで `DEBUG=False`。環境変数で本番用シークレットやホスト名を切替。
- CORS許可: `http://localhost` / `127.0.0.1` の 3000/8080 ポートを許可（フロントエンド開発想定）。
- DRFはセッション認証と許可なしアクセス（開発用）を標準設定。ページネーションはページサイズ20。

## 開発の足がかり
1. `pip install -r requirements.txt` → `python manage.py migrate`
2. `python manage.py runserver` でローカル起動（Web UI / API いずれも利用可）。
3. テストは `python manage.py test` で27件実行可能（READMEバッジより）。

今後、APIエンドポイントや各アプリのビジネスロジックを深掘りする際の出発点として活用してください。
